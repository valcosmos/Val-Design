{"version":3,"file":"menu.stories-72c966f7.js","sources":["../../src/components/Menu/menu.tsx","../../src/components/Menu/subMenu.tsx","../../src/components/Menu/menuItem.tsx","../../src/components/Menu/index.tsx"],"sourcesContent":["import React, {\n  FC,\n  useState,\n  createContext,\n  CSSProperties,\n  ReactNode\n} from 'react'\nimport classNames from 'classnames'\nimport { MenuItemProps } from './menuItem'\n\ntype MenuMode = 'horizontal' | 'vertical'\nexport interface MenuProps {\n  /**\n   * 默认 active 的菜单项的索引值\n   */\n  defaultIndex?: string\n  className?: string\n  /**\n   * 菜单类型 横向或者纵向\n   */\n  mode?: MenuMode\n  /**\n   * 菜单样式\n   */\n  style?: CSSProperties\n  /**\n   * 点击菜单项触发的回掉函数\n   */\n  onSelect?: (selectedIndex: string) => void\n  /**\n   * 设置子菜单的默认打开 只在纵向模式下生效\n   */\n  defaultOpenSubMenus?: string[]\n\n  /**\n   * 子元素\n   */\n  children?: ReactNode | string\n}\ninterface IMenuContext {\n  index: string\n  onSelect?: (selectedIndex: string) => void\n  mode?: MenuMode\n  defaultOpenSubMenus?: string[]\n}\n\nexport const MenuContext = createContext<IMenuContext>({ index: '0' })\n/**\n * > 为网站提供导航功能的菜单。支持横向纵向两种模式，支持下拉菜单。\n *\n * ### 引用方法\n *\n * ```js\n *\n *  import { Menu } from 'v-design'\n *\n * ```\n */\nexport const Menu: FC<MenuProps> = (props) => {\n  const {\n    className,\n    mode,\n    style,\n    children,\n    defaultIndex,\n    onSelect,\n    defaultOpenSubMenus\n  } = props\n  const [currentActive, setActive] = useState(defaultIndex)\n  const classes = classNames('v-menu', className, {\n    'menu-vertical': mode === 'vertical',\n    'menu-horizontal': mode !== 'vertical'\n  })\n  const handleClick = (index: string) => {\n    setActive(index)\n    if (onSelect) {\n      onSelect(index)\n    }\n  }\n  const passedContext: IMenuContext = {\n    index: currentActive || '0',\n    onSelect: handleClick,\n    mode,\n    defaultOpenSubMenus\n  }\n  const renderChildren = () => {\n    return React.Children.map(children, (child, index) => {\n      const childElement =\n        child as React.FunctionComponentElement<MenuItemProps>\n      const { displayName } = childElement.type\n      if (displayName === 'MenuItem' || displayName === 'SubMenu') {\n        return React.cloneElement(childElement, {\n          index: index.toString()\n        })\n      } else {\n        console.error(\n          'Warning: Menu has a child which is not a MenuItem component'\n        )\n      }\n    })\n  }\n  return (\n    <ul className={classes} style={style} data-testid=\"test-menu\">\n      <MenuContext.Provider value={passedContext}>\n        {renderChildren()}\n      </MenuContext.Provider>\n    </ul>\n  )\n}\nMenu.defaultProps = {\n  defaultIndex: '0',\n  mode: 'horizontal',\n  defaultOpenSubMenus: []\n}\n\nexport default Menu\n","import React, {\n  useContext,\n  useState,\n  FunctionComponentElement,\n  ReactNode\n} from 'react'\nimport classNames from 'classnames'\nimport { MenuContext } from './menu'\nimport { MenuItemProps } from './menuItem'\nimport Icon from '../Icon/icon'\nimport Transition from '../Transition/transition'\nexport interface SubMenuProps {\n  index?: string\n  title: string\n  className?: string\n  children?: ReactNode | string\n}\n\nconst SubMenu: React.FC<SubMenuProps> = ({\n  index,\n  title,\n  children,\n  className\n}) => {\n  const context = useContext(MenuContext)\n  const openedSubMenus = context.defaultOpenSubMenus as Array<string>\n  const isOpend =\n    index && context.mode === 'vertical'\n      ? openedSubMenus.includes(index)\n      : false\n  const [menuOpen, setOpen] = useState(isOpend)\n  const classes = classNames('menu-item submenu-item', className, {\n    'is-active': context.index === index,\n    'is-opened': menuOpen,\n    'is-vertical': context.mode === 'vertical'\n  })\n  const handleClick = (e: React.MouseEvent) => {\n    e.preventDefault()\n    setOpen(!menuOpen)\n  }\n  let timer: any\n  const handleMouse = (e: React.MouseEvent, toggle: boolean) => {\n    clearTimeout(timer)\n    e.preventDefault()\n    timer = setTimeout(() => {\n      setOpen(toggle)\n    }, 300)\n  }\n  const clickEvents =\n    context.mode === 'vertical'\n      ? {\n          onClick: handleClick\n        }\n      : {}\n  const hoverEvents =\n    context.mode !== 'vertical'\n      ? {\n          onMouseEnter: (e: React.MouseEvent) => {\n            handleMouse(e, true)\n          },\n          onMouseLeave: (e: React.MouseEvent) => {\n            handleMouse(e, false)\n          }\n        }\n      : {}\n  const renderChildren = () => {\n    const subMenuClasses = classNames('v-submenu', {\n      'menu-opened': menuOpen\n    })\n    const childrenComponent = React.Children.map(children, (child, i) => {\n      const childElement = child as FunctionComponentElement<MenuItemProps>\n      if (childElement.type.displayName === 'MenuItem') {\n        return React.cloneElement(childElement, {\n          index: `${index}-${i}`\n        })\n      } else {\n        console.error(\n          'Warning: SubMenu has a child which is not a MenuItem component'\n        )\n      }\n    })\n    return (\n      <Transition in={menuOpen} timeout={300} animation=\"zoom-in-top\">\n        <ul className={subMenuClasses}>{childrenComponent}</ul>\n      </Transition>\n    )\n  }\n  return (\n    <li key={index} className={classes} {...hoverEvents}>\n      <div className=\"submenu-title\" {...clickEvents}>\n        {title}\n        <Icon icon=\"angle-down\" className=\"arrow-icon\" />\n      </div>\n      {renderChildren()}\n    </li>\n  )\n}\n\nSubMenu.displayName = 'SubMenu'\nexport default SubMenu\n","import React, { ReactNode, useContext } from 'react'\nimport classNames from 'classnames'\nimport { MenuContext } from './menu'\nexport interface MenuItemProps {\n  index?: string\n  disabled?: boolean\n  className?: string\n  style?: React.CSSProperties\n  children?: ReactNode | string\n}\n\nconst MenuItem: React.FC<MenuItemProps> = (props) => {\n  const { index, disabled, className, style, children } = props\n  const context = useContext(MenuContext)\n  const classes = classNames('menu-item', className, {\n    'is-disabled': disabled,\n    'is-active': context.index === index\n  })\n  const handleClick = () => {\n    if (context.onSelect && !disabled && typeof index === 'string') {\n      context.onSelect(index)\n    }\n  }\n  return (\n    <li className={classes} style={style} onClick={handleClick}>\n      {children}\n    </li>\n  )\n}\n\nMenuItem.displayName = 'MenuItem'\nexport default MenuItem\n","import Menu, { MenuProps } from './menu'\nimport SubMenu, { SubMenuProps } from './subMenu'\nimport MenuItem, { MenuItemProps } from './menuItem'\nimport { FC } from 'react'\nexport type IMenuComponent = FC<MenuProps> & {\n  Item: FC<MenuItemProps>\n  SubMenu: FC<SubMenuProps>\n}\n\nconst TransMenu = Menu as IMenuComponent\n\nTransMenu.Item = MenuItem\nTransMenu.SubMenu = SubMenu\n\nexport default TransMenu\n"],"names":["MenuContext","createContext","Menu","__name","props","className","mode","style","children","defaultIndex","onSelect","defaultOpenSubMenus","currentActive","setActive","useState","classes","classNames","passedContext","index","handleClick","renderChildren","React","child","childElement","displayName","console","_jsx","SubMenu","title","context","useContext","openedSubMenus","isOpend","menuOpen","setOpen","e","timer","handleMouse","toggle","clearTimeout","clickEvents","hoverEvents","subMenuClasses","childrenComponent","i","Transition","_jsxs","MenuItem","disabled","TransMenu","Item"],"mappings":"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"}